[{"path":"https://dmurdoch.github.io/ellipse/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Duncan Murdoch. Maintainer.","code":""},{"path":"https://dmurdoch.github.io/ellipse/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Murdoch D, Chow ED (2023). ellipse: Functions Drawing Ellipses Ellipse-Like Confidence Regions. https://github.com/dmurdoch/ellipse, https://dmurdoch.github.io/ellipse/.","code":"@Manual{,   title = {ellipse: Functions for Drawing Ellipses and Ellipse-Like Confidence Regions},   author = {Duncan Murdoch and E. D. Chow},   year = {2023},   note = {https://github.com/dmurdoch/ellipse, https://dmurdoch.github.io/ellipse/}, }"},{"path":"https://dmurdoch.github.io/ellipse/index.html","id":"ellipse","dir":"","previous_headings":"","what":"Functions for Drawing Ellipses and Ellipse-Like Confidence Regions","title":"Functions for Drawing Ellipses and Ellipse-Like Confidence Regions","text":"ellipse contains ellipse drawing routines designed pairwise confidence regions, including distorted ellipses nonlinear regression regions. also includes routine plotcorr() plotting correlation matrices using ellipses.","code":""},{"path":"https://dmurdoch.github.io/ellipse/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Functions for Drawing Ellipses and Ellipse-Like Confidence Regions","text":"CRAN, can installed using can install development version ellipse GitHub :","code":"install.packages(\"ellipse\") # install.packages(\"devtools\") devtools::install_github(\"dmurdoch/ellipse\")"},{"path":"https://dmurdoch.github.io/ellipse/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Functions for Drawing Ellipses and Ellipse-Like Confidence Regions","text":"Plot approximate pairwise confidence regions profile trace plots nonlinear fit:  plotcorr() function can plot matrix ellipses:","code":"data(Puromycin) Purboth <- nls(formula = rate ~ ((Vm + delV * (state == \"treated\"))    * conc)/(K + conc), data = Puromycin,    start = list(Vm = 160, delV = 40, K = 0.05)) Pur.prof <- profile(Purboth) ellipse::pairs(Pur.prof) library(ellipse) #>  #> Attaching package: 'ellipse' #> The following object is masked from 'package:graphics': #>  #>     pairs corr.mtcars <- cor(mtcars) ord <- order(corr.mtcars[1,]) xc <- corr.mtcars[ord, ord] colors <- c(\"#A50F15\",\"#DE2D26\",\"#FB6A4A\",\"#FCAE91\",\"#FEE5D9\",\"white\",             \"#EFF3FF\",\"#BDD7E7\",\"#6BAED6\",\"#3182BD\",\"#08519C\")    plotcorr(xc, col=colors[5*xc + 6])"},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Functions for drawing ellipses and ellipse-like confidence\nregions — ellipse-package","title":"Functions for drawing ellipses and ellipse-like confidence\nregions — ellipse-package","text":"package contains various routines drawing ellipses ellipse-like confidence regions, implementing plots described Murdoch Chow (1996). also routines implementing profile plots described Bates Watts (1988).","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functions for drawing ellipses and ellipse-like confidence\nregions — ellipse-package","text":"three groups routines ellipse package.  first consists involved plotcorr, implements plots described Murdoch Chow (1996). display correlations using ellipses, whose shape contours bivariate normal distribution matching correlation. second group implements version profile plots described Bates Watts (1988); see ellipse.profile pairs.profile. last group provide basis others, drawing ellipses based various S objects, including scalar correlations, covariance matrices arima, lm, nls fits:  see ellipse.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functions for drawing ellipses and ellipse-like confidence\nregions — ellipse-package","text":"Duncan Murdoch <murdoch@stats.uwo.ca> E. D. Chow (porting R Jesus M. Frias Celayeta <iosu@bureau.ucc.ie>) Maintainer: Duncan Murdoch <murdoch.duncan@gmail.com>","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Functions for drawing ellipses and ellipse-like confidence\nregions — ellipse-package","text":"Bates Watts (1988) Nonlinear Regression Analysis Applications. Wiley. doi:10.1002/9780470316757 . Murdoch, D.J. Chow, E.D. (1996). graphical display large correlation matrices. American Statistician 50, 178-180. doi:10.2307/2684435 .","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.arima0.html","id":null,"dir":"Reference","previous_headings":"","what":"Outline an approximate pairwise confidence region — ellipse.arima0","title":"Outline an approximate pairwise confidence region — ellipse.arima0","text":"function produces ellipsoidal outline approximate  pairwise confidence region ARIMA model fit.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.arima0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Outline an approximate pairwise confidence region — ellipse.arima0","text":"","code":"# S3 method for arima0 ellipse(x, which = c(1, 2), level = 0.95, t = sqrt(qchisq(level, 2)), ...)"},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.arima0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Outline an approximate pairwise confidence region — ellipse.arima0","text":"x first argument arima0 object, usually resulting call arima0(). selects pair parameters plotted.  default first two. level confidence level region.  Default 95%. t t statistic boundary ellipse. ... ellipse.default parameters may also used.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.arima0.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Outline an approximate pairwise confidence region — ellipse.arima0","text":"matrix columns x y outline confidence region.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.arima0.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Outline an approximate pairwise confidence region — ellipse.arima0","text":"summary function used obtain approximate covariance matrix fitted parameters.","code":""},{"path":[]},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.arima0.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Outline an approximate pairwise confidence region — ellipse.arima0","text":"","code":"data(USAccDeaths) fit <- arima0(USAccDeaths, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1))) # Plot the approximate 95% confidence region for the first two parameters # of the model plot(ellipse(fit), type = 'l') points(fit$coef[1], fit$coef[2])"},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.glm.html","id":null,"dir":"Reference","previous_headings":"","what":"Outline an approximate pairwise confidence region — ellipse.glm","title":"Outline an approximate pairwise confidence region — ellipse.glm","text":"function produces ellipsoidal outline approximate  pairwise confidence region generalized linear model fit.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.glm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Outline an approximate pairwise confidence region — ellipse.glm","text":"","code":"# S3 method for glm ellipse(x, which = c(1, 2), level = 0.95, t, npoints = 100,          dispersion, ...)"},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.glm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Outline an approximate pairwise confidence region — ellipse.glm","text":"x first argument glm object, usually resulting call glm(). selects pair parameters plotted.  default first two. level confidence level region.  Default 95%. t t statistic boundary ellipse.  Binomial Poisson families, sqrt(qchisq(level, 2)) used; distributions, sqrt(2*qf(level, 2, df)) df residual degrees freedom. npoints many points return ellipse. dispersion value dispersion use.  specified, treated fixed, chi-square limits t used. missing,  taken summary(x). ... ellipse.default parameters may also used.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.glm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Outline an approximate pairwise confidence region — ellipse.glm","text":"matrix columns named according outline confidence region.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.glm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Outline an approximate pairwise confidence region — ellipse.glm","text":"summary function used obtain approximate covariance matrix fitted parameters, dispersion estimate, degrees freedom.","code":""},{"path":[]},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.glm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Outline an approximate pairwise confidence region — ellipse.glm","text":"","code":"## Dobson (1990) Page 93: Randomized Controlled Trial :       counts <- c(18,17,15,20,10,20,25,13,12)      outcome <- gl(3,1,9)      treatment <- gl(3,3)      glm.D93 <- glm(counts ~ outcome + treatment, family=poisson())  # Plot an approximate 95 % confidence region for the two Outcome parameters    plot(ellipse(glm.D93, which = c(2,3)), type = 'l')   points(glm.D93$coefficients[2], glm.D93$coefficients[3])"},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.html","id":null,"dir":"Reference","previous_headings":"","what":"Make an ellipse — ellipse","title":"Make an ellipse — ellipse","text":"generic function returning ellipse outline confidence region two parameters.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make an ellipse — ellipse","text":"","code":"ellipse(x, ...) # S3 method for default ellipse(x, scale = c(1, 1), centre = c(0, 0), level = 0.95,      t = sqrt(qchisq(level, 2)), which = c(1, 2), npoints = 100, ...)"},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make an ellipse — ellipse","text":"x object. default method parameter x correlation -1 1 square positive definite matrix least 2x2 size. treated correlation covariance  multivariate normal distribution. ... Descendant methods may require additional parameters. scale x correlation matrix, standard deviations parameter can given scale parameter.  defaults c(1, 1), rescaling done. centre centre ellipse position. level confidence level pairwise confidence region.  default 0.95, 95% region.  used control size ellipse plotted.  vector levels may used. t size ellipse may also controlled specifying value t-statistic boundary.  defaults appropriate value confidence region. parameter selects pair variables matrix plotted.  default first 2. npoints number points used ellipse.  Default 100.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make an ellipse — ellipse","text":"npoints x 2 matrix returned columns named according row names matrix x (default 'x' 'y'), suitable plotting.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Make an ellipse — ellipse","text":"default method uses  (cos(theta + d/2), cos(theta - d/2)) parametrization ellipse,  cos(d) correlation parameters.","code":""},{"path":[]},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Make an ellipse — ellipse","text":"Murdoch, D.J. Chow, E.D. (1996). graphical display large  correlation matrices. American Statistician 50, 178-180. doi:10.2307/2684435 .","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make an ellipse — ellipse","text":"","code":"# Plot an ellipse corresponding to a 95% probability region for a # bivariate normal distribution with mean 0, unit variances and  # correlation 0.8. plot(ellipse(0.8), type = 'l')"},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.lm.html","id":null,"dir":"Reference","previous_headings":"","what":"Outline a pairwise confidence region for a linear model fit. — ellipse.lm","title":"Outline a pairwise confidence region for a linear model fit. — ellipse.lm","text":"function produces ellipsoidal outline pairwise confidence region linear model fit.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.lm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Outline a pairwise confidence region for a linear model fit. — ellipse.lm","text":"","code":"# S3 method for lm ellipse(x, which = c(1, 2), level = 0.95,      t = sqrt(2 * qf(level, 2, x$df.residual)), ...)"},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.lm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Outline a pairwise confidence region for a linear model fit. — ellipse.lm","text":"x first argument lm object, usually resulting call lm(). selects pair parameters plotted.  default first two. level confidence level region.  Default 95%. t t statistic boundary ellipse. ... ellipse.default parameters may also used.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.lm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Outline a pairwise confidence region for a linear model fit. — ellipse.lm","text":"matrix columns x y outline confidence region.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.lm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Outline a pairwise confidence region for a linear model fit. — ellipse.lm","text":"summary function used obtain covariance matrix fitted parameters.","code":""},{"path":[]},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.lm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Outline a pairwise confidence region for a linear model fit. — ellipse.lm","text":"","code":"# Plot the estimate and joint 90% confidence region for the displacement and cylinder # count linear coefficients in the mtcars dataset data(mtcars) fit <- lm(mpg ~ disp + cyl , mtcars) plot(ellipse(fit, which = c('disp', 'cyl'), level = 0.90), type = 'l') points(fit$coefficients['disp'], fit$coefficients['cyl'])"},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.nls.html","id":null,"dir":"Reference","previous_headings":"","what":"Outline an approximate pairwise confidence region — ellipse.nls","title":"Outline an approximate pairwise confidence region — ellipse.nls","text":"function produces ellipsoidal outline approximate  pairwise confidence region nonlinear model fit.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.nls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Outline an approximate pairwise confidence region — ellipse.nls","text":"","code":"# S3 method for nls ellipse(x, which = c(1, 2), level = 0.95,      t = sqrt(2 * qf(level, 2, s$df[2])), ...)"},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.nls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Outline an approximate pairwise confidence region — ellipse.nls","text":"x first argument nls object, usually resulting call nls(). selects pair parameters plotted.  default first two. level confidence level region.  Default 95%. t t statistic boundary ellipse. ... ellipse.default parameters may also used.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.nls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Outline an approximate pairwise confidence region — ellipse.nls","text":"matrix columns x y outline confidence region.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.nls.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Outline an approximate pairwise confidence region — ellipse.nls","text":"summary function used obtain approximate covariance matrix fitted parameters.","code":""},{"path":[]},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.nls.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Outline an approximate pairwise confidence region — ellipse.nls","text":"","code":"# Plot an approximate 95% confidence region for the weight and displacement # parameters in the Michaelis Menten model data(Puromycin) fit <- nls(rate ~ Vm*conc/(K + conc), data = Puromycin, subset = state==\"treated\",      start = list(K = 0.05, Vm = 200)) plot(ellipse(fit,which=c('Vm','K')), type = 'l') params <- fit$m$getPars() points(params['Vm'],params['K'])"},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.glm.html","id":null,"dir":"Reference","previous_headings":"","what":"Pairwise profile sketch\tfor GLM profiles — ellipse.profile.glm","title":"Pairwise profile sketch\tfor GLM profiles — ellipse.profile.glm","text":"routine approximates pairwise confidence region glm model.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.glm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pairwise profile sketch\tfor GLM profiles — ellipse.profile.glm","text":"","code":"# S3 method for profile.glm ellipse(x, which = c(1, 2), level = 0.95, t,      npoints = 100, dispersion, ...)"},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.glm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pairwise profile sketch\tfor GLM profiles — ellipse.profile.glm","text":"x object class profile.glm. pair parameters use. level level argument specifies confidence level asymptotic confidence region. t square root value contoured.  default, qchisq(level, 2) models fixed dispersion (.e. binomial Poisson), 2 * qf(level, 2, df) models, df residual degrees freedom. npoints many points use ellipse. dispersion specified, fixed dispersion assumed, otherwise dispersion taken model. ... Extra parameters used (compatibility generic).","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.glm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pairwise profile sketch\tfor GLM profiles — ellipse.profile.glm","text":"npoints x 2 matrix columns chosen parameter names,  approximates contour function profiled.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.glm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Pairwise profile sketch\tfor GLM profiles — ellipse.profile.glm","text":"function uses 4 point approximation contour described Appendix 6 Bates Watts (1988).  produces exact contour quadratic surfaces, good approximations mild deviations quadratic.  surface multimodal, algorithm likely produce nonsense.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.glm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Pairwise profile sketch\tfor GLM profiles — ellipse.profile.glm","text":"Bates Watts (1988). Nonlinear Regression Analysis Applications. Wiley. doi:10.1002/9780470316757 .","code":""},{"path":[]},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.glm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Pairwise profile sketch\tfor GLM profiles — ellipse.profile.glm","text":"","code":"## MASS has a pairs.profile function that conflicts with ours, so ## do a little trickery here    noMASS <- is.na(match('package:MASS', search()))    if (noMASS) require(MASS) #> Loading required package: MASS  ## Dobson (1990) Page 93: Randomized Controlled Trial :       counts <- c(18,17,15,20,10,20,25,13,12)      outcome <- gl(3,1,9)      treatment <- gl(3,3)      glm.D93 <- glm(counts ~ outcome + treatment, family=poisson())  ##  Plot an approximate 95% confidence region for the two outcome variables      prof.D93 <- profile(glm.D93)      plot(ellipse(prof.D93, which = 2:3), type = 'l')      lines(ellipse(glm.D93, which = 2:3), lty = 2)      params <- glm.D93$coefficients      points(params[2],params[3])        ##  Clean up our trickery    if (noMASS) detach('package:MASS')"},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.html","id":null,"dir":"Reference","previous_headings":"","what":"Pairwise profile sketch — ellipse.profile","title":"Pairwise profile sketch — ellipse.profile","text":"routine approximates contour function based profile function.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pairwise profile sketch — ellipse.profile","text":"","code":"# S3 method for profile ellipse(x, which = c(1, 2), level = 0.95, t = sqrt(qchisq(level, 2)),      npoints = 100, ...)"},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pairwise profile sketch — ellipse.profile","text":"x object class profile, e.g.  profile.glm MASS package. pair parameters use. level ellipse.profile function defaults assume profiled function -2 times log likelihood regular model.  assumption level argument specifies confidence level asymptotic confidence region. t square root value contoured. npoints many points use ellipse. ... Extra arguments used.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pairwise profile sketch — ellipse.profile","text":"npoints x 2 matrix columns chosen parameter names,  approximates contour function profiled.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Pairwise profile sketch — ellipse.profile","text":"function uses 4 point approximation contour described Appendix 6 Bates Watts (1988).  produces exact contour quadratic surfaces, good approximations mild deviations quadratic.  surface multimodal, algorithm likely produce nonsense.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Pairwise profile sketch — ellipse.profile","text":"Bates Watts (1988). Nonlinear Regression Analysis Applications. Wiley. doi:10.1002/9780470316757 .","code":""},{"path":[]},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Pairwise profile sketch — ellipse.profile","text":"","code":"# Plot an approximate 95% confidence region for the Puromycin # parameters Vm and K, and overlay the ellipsoidal region  data(Puromycin) Purboth <- nls(formula = rate ~ ((Vm + delV * (state == \"treated\"))   * conc)/(K + conc), data = Puromycin,   start = list(Vm = 160, delV = 40, K = 0.05)) Pur.prof <- profile(Purboth) plot(ellipse(Pur.prof, which = c('Vm', 'K')), type = 'l') lines(ellipse(Purboth, which = c('Vm', 'K')), lty = 2) params <- Purboth$m$getPars() points(params['Vm'],params['K'])"},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.nls.html","id":null,"dir":"Reference","previous_headings":"","what":"Pairwise profile sketch — ellipse.profile.nls","title":"Pairwise profile sketch — ellipse.profile.nls","text":"routine approximates pairwise confidence region nonlinear regression model.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.nls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pairwise profile sketch — ellipse.profile.nls","text":"","code":"# S3 method for profile.nls ellipse(x, which = c(1, 2), level = 0.95,            t = sqrt(2 * qf(level, 2, attr(x, \"summary\")$df[2])),            npoints = 100, ...)"},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.nls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pairwise profile sketch — ellipse.profile.nls","text":"x object class profile.nls. pair parameters use. level level argument specifies confidence level asymptotic confidence region. t square root value contoured. npoints many points use ellipse. ... Extra parameters used (compatibility generic).","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.nls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pairwise profile sketch — ellipse.profile.nls","text":"npoints x 2 matrix columns chosen parameter names,  approximates contour function profiled.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.nls.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Pairwise profile sketch — ellipse.profile.nls","text":"function uses 4 point approximation contour described Appendix 6 Bates Watts (1988).  produces exact contour quadratic surfaces, good approximations mild deviations quadratic.  surface multimodal, algorithm likely produce nonsense.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.nls.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Pairwise profile sketch — ellipse.profile.nls","text":"Bates Watts (1988). Nonlinear Regression Analysis Applications. Wiley. doi:10.1002/9780470316757 .","code":""},{"path":[]},{"path":"https://dmurdoch.github.io/ellipse/reference/ellipse.profile.nls.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Pairwise profile sketch — ellipse.profile.nls","text":"","code":"# Plot an approximate 95% confidence region for the Puromycin # parameters Vm and K, and overlay the ellipsoidal region data(Puromycin) Purboth <- nls(formula = rate ~ ((Vm + delV * (state == \"treated\"))   * conc)/(K + conc), data = Puromycin,   start = list(Vm = 160, delV = 40, K = 0.05)) Pur.prof <- profile(Purboth) plot(ellipse(Pur.prof, which = c('Vm', 'K')), type = 'l') lines(ellipse(Purboth, which = c('Vm', 'K')), lty = 2) params <- Purboth$m$getPars() points(params['Vm'],params['K'])"},{"path":"https://dmurdoch.github.io/ellipse/reference/pairs.html","id":null,"dir":"Reference","previous_headings":"","what":"Scatterplot Matrix — pairs","title":"Scatterplot Matrix — pairs","text":"matrix scatterplots produced.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/pairs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scatterplot Matrix — pairs","text":"","code":"pairs(x, ...) # S3 method for default pairs(x, ...) # S3 method for formula pairs(formula, data = NULL, ..., subset,       na.action = stats::na.pass)"},{"path":"https://dmurdoch.github.io/ellipse/reference/pairs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scatterplot Matrix — pairs","text":"x object containing data plot. formula, data, subset, na.action See pairs . ... arguments pass methods.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/pairs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Scatterplot Matrix — pairs","text":"ellipse package defines pairs.profile  method profile objects.  Unfortunately, MASS package.  ellipse::pairs generic supplied allow users choose use version package.  See pairs.profile help page details.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/pairs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scatterplot Matrix — pairs","text":"Typically useful value produced; generic function called side effect producing  display.","code":""},{"path":[]},{"path":"https://dmurdoch.github.io/ellipse/reference/pairs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scatterplot Matrix — pairs","text":"","code":"example(pairs, \"graphics\") #>  #> pairs> pairs(iris[1:4], main = \"Anderson's Iris Data -- 3 species\", #> pairs+       pch = 21, bg = c(\"red\", \"green3\", \"blue\")[unclass(iris$Species)])  #>  #> pairs> ## formula method, \"graph\" layout (row 1 at bottom): #> pairs> pairs(~ Fertility + Education + Catholic, data = swiss, row1attop=FALSE, #> pairs+       subset = Education < 20, main = \"Swiss data, Education < 20\")  #>  #> pairs> pairs(USJudgeRatings, gap=1/10) # (gap: not wasting plotting area)  #>  #> pairs> ## show only lower triangle (and suppress labeling for whatever reason): #> pairs> pairs(USJudgeRatings, text.panel = NULL, upper.panel = NULL)  #>  #> pairs> ## put histograms on the diagonal #> pairs> panel.hist <- function(x, ...) #> pairs+ { #> pairs+     usr <- par(\"usr\") #> pairs+     par(usr = c(usr[1:2], 0, 1.5) ) #> pairs+     h <- hist(x, plot = FALSE) #> pairs+     breaks <- h$breaks; nB <- length(breaks) #> pairs+     y <- h$counts; y <- y/max(y) #> pairs+     rect(breaks[-nB], 0, breaks[-1], y, col = \"cyan\", ...) #> pairs+ } #>  #> pairs> pairs(USJudgeRatings[1:5], panel = panel.smooth, #> pairs+       cex = 1.5, pch = 24, bg = \"light blue\", horOdd=TRUE, #> pairs+       diag.panel = panel.hist, cex.labels = 2, font.labels = 2)  #>  #> pairs> ## put (absolute) correlations on the upper panels, #> pairs> ## with size proportional to the correlations. #> pairs> panel.cor <- function(x, y, digits = 2, prefix = \"\", cex.cor, ...) #> pairs+ { #> pairs+     par(usr = c(0, 1, 0, 1)) #> pairs+     r <- abs(cor(x, y)) #> pairs+     txt <- format(c(r, 0.123456789), digits = digits)[1] #> pairs+     txt <- paste0(prefix, txt) #> pairs+     if(missing(cex.cor)) cex.cor <- 0.8/strwidth(txt) #> pairs+     text(0.5, 0.5, txt, cex = cex.cor * r) #> pairs+ } #>  #> pairs> pairs(USJudgeRatings, lower.panel = panel.smooth, upper.panel = panel.cor, #> pairs+       gap=0, row1attop=FALSE)  #>  #> pairs> pairs(iris[-5], log = \"xy\") # plot all variables on log scale  #>  #> pairs> pairs(iris, log = 1:4, # log the first four #> pairs+       main = \"Lengths and Widths in [log]\", line.main=1.5, oma=c(2,2,3,2))"},{"path":"https://dmurdoch.github.io/ellipse/reference/pairs.profile.html","id":null,"dir":"Reference","previous_headings":"","what":"Profile pairs — pairs.profile","title":"Profile pairs — pairs.profile","text":"function produces pairwise plots profile traces, profile sketches, ellipse approximations confidence intervals.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/pairs.profile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Profile pairs — pairs.profile","text":"","code":"# S3 method for profile pairs(x, labels = c(names(x), \"Profile tau\"), panel = lines, invert = TRUE,      plot.tau = TRUE, plot.trace = TRUE, plot.sketch = TRUE,    plot.ellipse = FALSE, level = 0.95, ...)"},{"path":"https://dmurdoch.github.io/ellipse/reference/pairs.profile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Profile pairs — pairs.profile","text":"x object class profile, generally result profile() function. labels labels use variable.  default variable names. panel function use draw sketch panel. invert Whether swap axes things look better. plot.tau Whether profile tau (profile t) plots. plot.trace Whether profile trace plots. plot.sketch Whether profile sketch plots. plot.ellipse Whether ellipse approximations. level nominal confidence level profile sketches ellipses. ... plotting parameters.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/pairs.profile.html","id":"side-effects","dir":"Reference","previous_headings":"","what":"Side Effects","title":"Profile pairs — pairs.profile","text":"Produces plot current device pair variables profile object.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/pairs.profile.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Profile pairs — pairs.profile","text":"function implements plots used Bates Watts (1988) nonlinear regression diagnostics. Unfortunately, MASS package also defines pairs.profile method.  ellipse::pairs generic supplied allow users choose use version package. x profile object, ellipse::pairs(x)  guaranteed call method package.  rather use MASS method, two steps needed:  need sure MASS loaded, call graphics::pairs(x).  (MASS loaded, get default method graphics package, trigger error since know profile objects.) ellipse MASS loaded, pairs(x)  slightly ambiguous:  method called depends ordering ellipse graphics (MASS!) search list.  almost cases ellipse precede graphics, ellipse method usually default. x object profile object, ellipse::pairs(x) pass call graphics::pairs(x), standard method called.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/pairs.profile.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Profile pairs — pairs.profile","text":"Bates Watts (1988). Nonlinear Regression Analysis Applications. Wiley. doi:10.1002/9780470316757 .","code":""},{"path":[]},{"path":"https://dmurdoch.github.io/ellipse/reference/pairs.profile.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Profile pairs — pairs.profile","text":"","code":"# Plot everything for the Puromycin data  data(Puromycin)  Purboth <- nls(formula = rate ~ ((Vm + delV * (state == \"treated\"))    * conc)/(K + conc), data = Puromycin,    start = list(Vm = 160, delV = 40, K = 0.05))  Pur.prof <- profile(Purboth)  ellipse::pairs(Pur.prof, plot.ellipse = TRUE)     # Show the corresponding plot from MASS:  if (requireNamespace(\"MASS\"))    graphics::pairs(Pur.prof)"},{"path":"https://dmurdoch.github.io/ellipse/reference/plotcorr.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot correlation matrix ellipses — plotcorr","title":"Plot correlation matrix ellipses — plotcorr","text":"function plots correlation matrix using ellipse-shaped glyphs entry.  ellipse represents level curve density bivariate normal matching correlation.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/plotcorr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot correlation matrix ellipses — plotcorr","text":"","code":"plotcorr(corr, outline = TRUE, col = 'grey', numbers = FALSE,           type = c(\"full\",\"lower\",\"upper\"),          diag = (type == \"full\"), bty = \"n\", axes = FALSE,          xlab = \"\", ylab = \"\", asp = 1,          cex.lab = par(\"cex.lab\"), cex = 0.75*par(\"cex\"),          mar = 0.1 + c(2,2,4,2), ...)"},{"path":"https://dmurdoch.github.io/ellipse/reference/plotcorr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot correlation matrix ellipses — plotcorr","text":"corr matrix containing entries -1 1 plotted correlations. outline Whether ellipses outlined default colour. col colour(s) use fill ellipses. numbers Whether plot numerical correlations place ellipses.  numbers TRUE, correlations rounded single decimal place placed plot. type Character. Plot \"full\" matrix just \"upper\"   \"lower\" triangular part . diag Logical. Plot diagonal elements . bty, axes, xlab, ylab, asp, mar, cex.lab, ... Graphical parameters passed plot plotting. cex Graphical parameter passed text plotting.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/plotcorr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot correlation matrix ellipses — plotcorr","text":"ellipses plotted tangent unit character square, shape chosen match required correlation.  numbers = FALSE, col vector recycled colour ellipses; TRUE, ignored.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/plotcorr.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Plot correlation matrix ellipses — plotcorr","text":"Murdoch, D.J. Chow, E.D. (1996). graphical display large correlation matrices. American Statistician 50, 178-180. doi:10.2307/2684435 .","code":""},{"path":[]},{"path":"https://dmurdoch.github.io/ellipse/reference/plotcorr.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot correlation matrix ellipses — plotcorr","text":"Duncan Murdoch; Gregor Gorjanc suggested type diag options.","code":""},{"path":"https://dmurdoch.github.io/ellipse/reference/plotcorr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot correlation matrix ellipses — plotcorr","text":"","code":"save.par <- par(ask = interactive())  # Plot the correlation matrix for the mtcars data full model fit  data(mtcars) fit <- lm(mpg ~ ., mtcars) plotcorr(summary(fit, correlation = TRUE)$correlation)   # Plot a second figure with numbers in place of the # ellipses plotcorr(summary(fit, correlation = TRUE)$correlation, numbers = TRUE)   # Colour the ellipses to emphasize the differences.  The color range # is based on RColorBrewer's Reds and Blues (suggested by Gregor Gorjanc)  corr.mtcars <- cor(mtcars) ord <- order(corr.mtcars[1,]) xc <- corr.mtcars[ord, ord] colors <- c(\"#A50F15\",\"#DE2D26\",\"#FB6A4A\",\"#FCAE91\",\"#FEE5D9\",\"white\",             \"#EFF3FF\",\"#BDD7E7\",\"#6BAED6\",\"#3182BD\",\"#08519C\")    plotcorr(xc, col=colors[5*xc + 6])   plotcorr(xc, col=colors[5*xc + 6], type = \"upper\")  plotcorr(xc, col=colors[5*xc + 6], type = \"lower\", diag = TRUE)  par(save.par)"},{"path":"https://dmurdoch.github.io/ellipse/news/index.html","id":"ellipse-044","dir":"Changelog","previous_headings":"","what":"ellipse 0.4.4","title":"ellipse 0.4.4","text":"Put source Github. Added NEWS.md file track changes package. Added README.Rmd. Added pkgdown site.","code":""},{"path":"https://dmurdoch.github.io/ellipse/news/index.html","id":"ellipse-043-may-2022","dir":"Changelog","previous_headings":"","what":"ellipse 0.4.3 (May 2022)","title":"ellipse 0.4.3 (May 2022)","text":"CRAN release: 2022-05-31 request CRAN, fixed references.","code":""},{"path":"https://dmurdoch.github.io/ellipse/news/index.html","id":"ellipse-042-may-2020","dir":"Changelog","previous_headings":"","what":"ellipse 0.4.2 (May 2020)","title":"ellipse 0.4.2 (May 2020)","text":"CRAN release: 2020-05-27 Update maintainer email.","code":""},{"path":"https://dmurdoch.github.io/ellipse/news/index.html","id":"ellipse-041-jan-2018","dir":"Changelog","previous_headings":"","what":"ellipse 0.4.1 (Jan 2018)","title":"ellipse 0.4.1 (Jan 2018)","text":"CRAN release: 2018-01-05 request CRAN, added pairs() generic function avoid clash MASS::pairs.profile() minor cleanups.","code":""},{"path":"https://dmurdoch.github.io/ellipse/news/index.html","id":"ellipse-038-apr-2013","dir":"Changelog","previous_headings":"","what":"ellipse 0.3.8 (Apr 2013)","title":"ellipse 0.3.8 (Apr 2013)","text":"Minor fix (\\synopsis tag help)","code":""},{"path":"https://dmurdoch.github.io/ellipse/news/index.html","id":"ellipse-037-mar-2012","dir":"Changelog","previous_headings":"","what":"ellipse 0.3.7 (Mar 2012)","title":"ellipse 0.3.7 (Mar 2012)","text":"Minor fix (clean DESCRIPTION file)","code":""},{"path":"https://dmurdoch.github.io/ellipse/news/index.html","id":"ellipse-036-apr-2009","dir":"Changelog","previous_headings":"","what":"ellipse 0.3.6 (Apr 2009)","title":"ellipse 0.3.6 (Apr 2009)","text":"Bug fix: ... passed methods ellipse.default().","code":""},{"path":"https://dmurdoch.github.io/ellipse/news/index.html","id":"ellipse-035-sep-2007","dir":"Changelog","previous_headings":"","what":"ellipse 0.3.5 (Sep 2007)","title":"ellipse 0.3.5 (Sep 2007)","text":"License clarification","code":""},{"path":"https://dmurdoch.github.io/ellipse/news/index.html","id":"ellipse-034-nov-2006","dir":"Changelog","previous_headings":"","what":"ellipse 0.3.4 (Nov 2006)","title":"ellipse 0.3.4 (Nov 2006)","text":"Update strict test compliance","code":""},{"path":"https://dmurdoch.github.io/ellipse/news/index.html","id":"ellipse-033-nov-2006","dir":"Changelog","previous_headings":"","what":"ellipse 0.3.3 (Nov 2006)","title":"ellipse 0.3.3 (Nov 2006)","text":"Nicer colors plotcorr() example (Gregor Gorjanc)","code":""},{"path":"https://dmurdoch.github.io/ellipse/news/index.html","id":"ellipse-032-feb-2006","dir":"Changelog","previous_headings":"","what":"ellipse 0.3.2 (Feb 2006)","title":"ellipse 0.3.2 (Feb 2006)","text":"Remove deprecated install.R","code":""},{"path":"https://dmurdoch.github.io/ellipse/news/index.html","id":"ellipse-031-june-2005","dir":"Changelog","previous_headings":"","what":"ellipse 0.3.1 (June 2005)","title":"ellipse 0.3.1 (June 2005)","text":"Added NAMESPACE, package overview topic","code":""},{"path":"https://dmurdoch.github.io/ellipse/news/index.html","id":"ellipse-0215-may-2005","dir":"Changelog","previous_headings":"","what":"ellipse 0.2.15 (May 2005)","title":"ellipse 0.2.15 (May 2005)","text":"Allowed plotcorr() plot just upper lower triangle matrix.","code":""},{"path":"https://dmurdoch.github.io/ellipse/news/index.html","id":"ellipse-0214-aug-2004","dir":"Changelog","previous_headings":"","what":"ellipse 0.2.14 (Aug 2004)","title":"ellipse 0.2.14 (Aug 2004)","text":"Allowed separate colors ellipse plotcorr() fixed .Rd errors.","code":""},{"path":"https://dmurdoch.github.io/ellipse/news/index.html","id":"ellipse-0212-jan-2004","dir":"Changelog","previous_headings":"","what":"ellipse 0.2.12 (Jan 2004)","title":"ellipse 0.2.12 (Jan 2004)","text":"Bug fix missing values plotcorr(), doc error","code":""}]
